extends index

block content
  script(src='https://code.jquery.com/jquery-3.5.0.min.js')
  script.
    document.addEventListener('play', function(e){
    var audios = document.getElementsByTagName('audio');
    for(var i = 0, len = audios.length; i < len;i++){
    if(audios[i] != e.target){
    audios[i].pause();
    }
    }
    }, true);

  script.
    function toggleVisible(){
    var x = document.getElementById("tunesoftheweek");
    var y = document.getElementById("tuneslink");

    if(x.style.display == 'none' || x.style.display == ''){
    x.style.display = 'block';
    }else{
    x.style.display = 'none';
    }

    if (y.innerHTML === "Click Here for Tunes of the Week!") {
    y.innerHTML = "^^^ Collapse List ^^^";
    } else {
    y.innerHTML = "Click Here for Tunes of the Week!";
    }
    }

  .artisth1
    a#tuneslink(title='Totw', href='', onclick='toggleVisible();return false;') Click Here for Tunes of the Week!


  - var y = totw;
  - var userid = currentuserid;


  div#tunesoftheweek
    .ulcontaintotw
      each track in y
        ul
          .uldivtotw
            li.tunetexttotw= `${track.artist_name} - ${track.track_name}`
            .totw
              audio(src=track.drive_url, type='audio/mpeg', controls='') Sorry Bruv, Your Browser Can't Play dis chune!
            li.tunetexttotw= `       `
            .downloadbutton
              a(href=track.drive_url)
                img(border='0', alt='Download Tune', src='Images/PageIMG/download.png', height='35', width='160')
              form(method='POST' action=`/`)
                div.form-group
                  input#track_id.form-control(type='hidden', name='track_id', value=`${track.id}`)
                div.form-group
                  input#favetrack_name.form-control(type='hidden', name='favetrack_name', value=`${track.track_name}`)
                div.form-group
                  input#user_id.form-control(type='hidden', name='user_id', value=`${userid}`)
                div.form-group
                  input#name.form-control(type='hidden', name='name', value=`${track.artist_name}`)
                div
                  input(type='submit', value='Add to Favorites')
                br
            li.tunetexttotw= `  ­   ­   ­   ­   ­   ­   ­   ­   ­   ­   ­   ­   ­   ­   ­   ­ `
            a(href="")
  br
  - var message = msg;
  - var shuffleart = randartistname;
  - var shuffletrack = randtrackname;
  - var shuffleurl = randdriveurl;
  
  .middlecontain
    .searchcontain
      .searchform
        form(method='POST' action='/search')
          div.form-group
            label.boldtext(for='search_results') Artist Search
            input#search_results.form-control(type='text', name='search_results' placeholder="Search for Artist/Crew...")
          div.form-group
            label.boldtext(for='search_style') Search For Artist
            input#search_style.form-control(type='radio', name='search_style', checked="checked", value=0)
            label.boldtext(for='search_style') Search For Crew
            input#search_style.form-control(type='radio', name='search_style', value=1)
          div
            button.btn.btn-primary.btn-block(type='submit') Submit
          div
            form
            input(type='button', value='Reload back to All Artists', onclick="self.location='https://riddim-archive.herokuapp.com/'")
    .shufflecontain
      p.boldtext SHUFFLE PLAYER
      #shuftext
        text.boldtext= `${shuffleart} - ${shuffletrack}`
      .downloadbutton
        audio(id='shufaudio', type='audio/mpeg', controls='')
            source(id='shufaudiosrc' src=`${shuffleurl}`)
        #shuffleforward
          img(border='0', alt='back', src='Images/PageIMG/forward.png', height='45')
      #loadtext.boldtext
  br
  .labelgcenter #{message}
  - var x = artists;

  .fishcontain
    .fish
      .fishchild
        each artist in x
          a(href=`artist/${artist.artist_name}`)
            img(src=`Images/Logos/${artist.artist_name}.jpg` alt="ADD ARTIST IMG HERE" height='275' width='275')

  script.
    document.getElementById('shuffleforward').addEventListener('click', makeNextRequest);
    function makeNextRequest(e){
    document.getElementById('loadtext').innerHTML= "Loading..."
    console.log("CALLING FCN");
    $.ajax({
    url:'/forward',
    type : 'POST',
    success: function(data){
    var thetext = document.createElement('text');
    thetext.setAttribute('class', 'boldtext');
    thetext.innerHTML = `${data.artist_name} - ${data.track_name}`;
    var shuffy = document.getElementById('shuftext');
    shuffy.innerHTML= "";
    shuffy.appendChild(thetext);

    document.getElementById('shufaudiosrc').src = `${data.source}`;
    var audiop = document.getElementById('shufaudio');
    audiop.load();
    audiop.play();
    document.getElementById('loadtext').innerHTML= "";
    },
    error: function(){
    console.log("Didn't Work");
    }
    });
    }
